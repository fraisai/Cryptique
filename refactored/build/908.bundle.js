/*! For license information please see 908.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkcrypt_edit=self.webpackChunkcrypt_edit||[]).push([[908],{635:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(26),{OFFER:i,ANSWER:l,ICECANDIDATE:o,LOGIN:c,LEAVE:s}=r(n(21)).default;t.default=class{constructor(e){this.webSocketServer="number"==typeof e?new a.WebSocket.Server({port:e}):new a.WebSocket.Server({server:e}),this.users=new Map}initializeConnection(){this.webSocketServer.on("connection",n=>{console.log("A user has connected to the websocket server."),n.on("close",()=>{var e=this.getByValue(this.users,n);this.users.delete(e),n.terminate();const t={ACTION_TYPE:c,payload:Array.from(this.users.keys())};this.webSocketServer.clients.forEach(e=>e.send(JSON.stringify(t)))}),n.on("message",e=>{var e=e.toString("utf-8"),t=JSON.parse(e);switch(t.ACTION_TYPE){case i:case l:case o:this.transmit(t);break;case c:this.users.set(t.payload,n),this.webSocketServer.clients.forEach(e=>e.send(JSON.stringify({ACTION_TYPE:c,payload:Array.from(this.users.keys())})));break;case s:this.transmit(t);break;default:console.error("error",t)}})})}transmit(e){var t;null!=(t=this.users.get(e.receiver))&&t.send(JSON.stringify(e))}getByValue(e,t){let n="";for(var[r,a]of e.entries())a===t&&(n=r);return n}}},758:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(294)),{LOGIN:c,ICECANDIDATE:s,OFFER:u,ANSWER:d,LEAVE:f}=r(n(21)).default;t.default=({ws:e,getUsers:n,handleReceiveCall:r,handleAnswer:a,handleNewIceCandidate:i,endCall:l})=>(e.addEventListener("open",()=>{console.log("Websocket connection has opened.")}),e.addEventListener("close",()=>{console.log("Websocket connection closed.")}),e.addEventListener("error",e=>{console.error("Socket Error:",e)}),e.addEventListener("message",e=>{var t=JSON.parse(e.data);switch(t.ACTION_TYPE){case c:n(t);break;case u:r(t);break;case d:a(t);break;case s:i(t);break;case f:l(!0);break;default:console.error("error",t)}}),o.default.createElement(o.default.Fragment,null))},925:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},E=this&&this.__awaiter||function(e,l,o,c){return new(o=o||Promise)(function(n,t){function r(e){try{i(c.next(e))}catch(e){t(e)}}function a(e){try{i(c.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof o?t:new o(function(e){e(t)})).then(r,a)}i((c=c.apply(e,l||[])).next())})},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const _=i(n(294)),C=l(n(758)),x=l(n(898));i=l(n(21));const k=l(n(186)),O=l(n(422)),{LOGIN:N,ICECANDIDATE:w,OFFER:S,ANSWER:T,LEAVE:I}=i.default;t.default=({URL:e,mediaOptions:t})=>{const[r,n]=(0,_.useState)(""),[a,i]=(0,_.useState)(),l=(0,_.useRef)(null),o=(0,_.useRef)(null),c=(0,_.useRef)(null),s=(0,_.useRef)(null),u=(0,_.useRef)(),d=(0,_.useRef)(null),f=(0,_.useRef)([]);let p="",v;(0,_.useEffect)(()=>{l.current=new WebSocket(e),m()},[]);const m=()=>E(void 0,void 0,void 0,function*(){try{o.current&&(d.current=o.current.srcObject=yield navigator.mediaDevices.getUserMedia(k.default))}catch(e){console.log("Error in openUserMedia: ",e)}}),g=n=>{var e=new RTCPeerConnection(O.default);return e.onicecandidate=h,e.ontrack=b,e.onnegotiationneeded=()=>{var t,e;t=n,null!=(e=s.current)&&e.createOffer().then(e=>{var t;return null==(t=s.current)?void 0:t.setLocalDescription(e)}).then(()=>{var e={ACTION_TYPE:S,sender:r,receiver:t,payload:null==(e=s.current)?void 0:e.localDescription};l.current.send(JSON.stringify(e))}).catch(e=>console.log(e))},console.log("registerPeerConnectionListners has activated"),e.addEventListener("negotiationneeded",()=>{console.log("negotiationneeded event has fired")}),e.addEventListener("icegatheringstatechange",()=>{var e;console.log("ICE gathering state changed: "+(null==(e=s.current)?void 0:e.iceGatheringState))}),e.addEventListener("connectionstatechange",()=>{var e;console.log("Connection state change: "+(null==(e=s.current)?void 0:e.connectionState)),console.log(s.current)}),e.addEventListener("signalingstatechange",()=>{var e;console.log("Signaling state change: "+(null==(e=s.current)?void 0:e.signalingState))}),e.addEventListener("iceconnectionstatechange ",()=>{var e;console.log("ICE connection state change: "+(null==(e=s.current)?void 0:e.iceConnectionState))}),e};function h(e){e.candidate&&(e={ACTION_TYPE:w,receiver:u.current,payload:e.candidate},l.current.send(JSON.stringify(e)))}function b(e){c.current.srcObject=e.streams[0]}function y(e){var t,n={ACTION_TYPE:I,receiver:u.current};null!=(t=s.current)&&t.close(),e?null!=(t=s.current)&&t.close():null!=(e=l.current)&&e.send(JSON.stringify(n)),c.current.srcObject=null}return _.default.createElement(_.default.Fragment,null,l.current?_.default.createElement(C.default,{ws:l.current,getUsers:e=>{e=e.payload.map((e,t)=>_.default.createElement("div",{key:t},e));i(e)},handleReceiveCall:function(t){u.current=t.sender,s.current=g(t.sender);var e=new RTCSessionDescription(t.payload);s.current.setRemoteDescription(e).then(()=>{var e;null!=(e=d.current)&&e.getTracks().forEach(e=>{var t;return null==(t=s.current)?void 0:t.addTrack(e,d.current)})}).then(()=>{var e;return null==(e=s.current)?void 0:e.createAnswer()}).then(e=>{var t;return null==(t=s.current)?void 0:t.setLocalDescription(e)}).then(()=>{var e={ACTION_TYPE:T,receiver:t.sender,sender:r,payload:null==(e=s.current)?void 0:e.localDescription};l.current.send(JSON.stringify(e))})},handleAnswer:function(e){var t,e=new RTCSessionDescription(e.payload);null!=(t=s.current)&&t.setRemoteDescription(e).catch(e=>console.log(e))},handleNewIceCandidate:function(e){var t,e=new RTCIceCandidate(e.payload);null!=(t=s.current)&&t.addIceCandidate(e).catch(e=>console.log(e))},endCall:y}):"",_.default.createElement("div",{className:"div1",style:{display:"flex",flexDirection:"column",justifyContent:"space-around",marginTop:"10%",padding:"10px"}},""===r?_.default.createElement(_.default.Fragment,null,_.default.createElement("div",{className:"input-div",style:{alignItems:"center",display:"flex",flexDirection:"column",height:"100px",justifyContent:"center",left:"2%",margin:"0 auto",top:"2%",width:"100px"}},_.default.createElement("input",{className:"input-username",type:"text",placeholder:"username",id:"username-field",onChange:e=>p=e.target.value,style:{paddingBottom:"40px",width:"200px"}}),_.default.createElement("button",{className:"submit-username-btn","data-testid":"submit-username-btn",onClick:()=>{return e={ACTION_TYPE:N,payload:p},l.current.send(JSON.stringify(e)),void n(p);var e},style:{backgroundColor:"#C2FBD7",borderRadius:"50px",borderWidth:"0",boxShadow:"rgba(0, 0, 0, 0.15) 0px 2px 8px",color:"#008000",cursor:"pointer",display:"inline-block",fontFamily:"Arial, Helvetica, sans-serif",fontSize:"1em",height:"50px",padding:"0 25px"}},"Submit Username"))):_.default.createElement("div",{className:"users-list",style:{fontFamily:"Arial, Helvetica, sans-serif",fontSize:"16px"}},"Connected Users: ",a),_.default.createElement("div",{id:"main-video-container",className:"",style:{alignItems:"center",display:"flex",flexDirection:"row",gap:"100px",justifyContent:"center"}},_.default.createElement("div",{id:"local-video-container",className:"",style:{alignContent:"center",display:"flex",flexDirection:"column",justifyContent:"center"}},_.default.createElement(x.default,{video:o,mediaOptions:t}),_.default.createElement("div",{id:"local-button-container",className:"",style:{display:"flex",flexDirection:"row",gap:"10px",justifyContent:"center",marginTop:"10px"}},_.default.createElement("button",{className:"share-btn","data-testid":"share-screen-btn",onClick:()=>{navigator.mediaDevices.getDisplayMedia().then(e=>{var t,n=e.getTracks()[0];null!=(t=null==(t=f.current)?void 0:t.find(e=>{return"video"===(null==(e=e.track)?void 0:e.kind)}))&&t.replaceTrack(n),o.current.srcObject=e,n.onended=function(){var e;null!=(e=null==(e=f.current)?void 0:e.find(e=>{return"video"===(null==(e=e.track)?void 0:e.kind)}))&&e.replaceTrack(d.current.getTracks()[1]),o.current.srcObject=d.current}})},style:{backgroundColor:"#C2FBD7",borderRadius:"50px",borderWidth:"0",boxShadow:"rgba(0, 0, 0, 0.15) 0px 2px 8px",color:"#008000",cursor:"pointer",display:"inline-block",fontFamily:"Arial, Helvetica, sans-serif",fontSize:"1em",height:"50px",padding:"0 25px"}},"Share Screen"),_.default.createElement("button",{className:"end-btn","data-testid":"end-call-btn",onClick:()=>y(!1),style:{backgroundColor:"#ff6961",borderRadius:"50px",borderWidth:"0",boxShadow:"rgba(0, 0, 0, 0.15) 0px 2px 8px",color:"#28282B",cursor:"pointer",display:"inline-block",fontFamily:"Arial, Helvetica, sans-serif",fontSize:"1em",height:"50px",padding:"0 25px"}},"End Call"))),_.default.createElement("div",{id:"remote-video-container",className:"",style:{alignContent:"center",display:"flex",flexDirection:"column",justifyContent:"center"}},_.default.createElement(x.default,{video:c,mediaOptions:t}),_.default.createElement("div",{id:"remote-button-container",className:"",style:{display:"flex",flexDirection:"row",gap:"10px",justifyContent:"center",marginTop:"10px"}},_.default.createElement("button",{className:"call-btn","data-testid":"call-btn",onClick:()=>{var e=document.querySelector("#receiverName");e&&(v=e.value,e.value="",u.current=v,e=v,s.current=g(e),d.current.getTracks().forEach(e=>f.current.push(s.current.addTrack(e,d.current))))},style:{backgroundColor:"#C2FBD7",borderRadius:"50px",borderWidth:"0",boxShadow:"rgba(0, 0, 0, 0.15) 0px 2px 8px",color:"#008000",cursor:"pointer",display:"inline-block",fontFamily:"Arial, Helvetica, sans-serif",fontSize:"1em",height:"50px",padding:"0 25px"}},"Call"),_.default.createElement("input",{className:"input-receiver-name",type:"text",id:"receiverName",style:{marginLeft:"2%"}}))))))}},898:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(n(294));t.default=({video:e,mediaOptions:t={controls:!0,style:{width:"640px",height:"360px"}}})=>{var{controls:t,style:n}=t;return a.default.createElement(a.default.Fragment,null,a.default.createElement("video",{className:"videoPlayer",autoPlay:!0,playsInline:!0,controls:t,ref:e,style:n}))}},21:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});t.default={CONNECTION:"CONNECTION",OFFER:"OFFER",ANSWER:"ANSWER",LOGIN:"LOGIN",ICECANDIDATE:"ICECANDIDATE",LEAVE:"LEAVE",CREATE_ROOM:"CREATE_ROOM",JOIN_ROOM:"JOIN_ROOM"}},186:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});t.default={video:{width:{min:640,ideal:1920,max:1920},height:{min:480,ideal:1080,max:1080}},audio:{echoCancellation:!0}}},422:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});t.default={iceServers:[{urls:"stun:stun1.l.google.com:19302"}],iceCandidatePoolSize:10}},425:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},a=(Object.defineProperty(t,"__esModule",{value:!0}),t.SignalingChannel=t.actions=t.VideoComponent=t.Socket=void 0,r(n(925))),i=r(n(758)),i=(t.Socket=i.default,r(n(898))),i=(t.VideoComponent=i.default,r(n(21))),i=(t.actions=i.default,r(n(635)));t.SignalingChannel=i.default,t.default=a.default},53:(e,o)=>{function i(e,t){var n=e.length;for(e.push(t);0<n;){var r=n-1>>>1,a=e[r];if(!(0<u(a,t)))break;e[r]=t,e[n]=a,n=r}}function c(e){return 0===e.length?null:e[0]}function s(e){if(0!==e.length){var t=e[0],n=e.pop();if(n!==t){e[0]=n;for(var r=0,a=e.length,i=a>>>1;r<i;){var l=2*(r+1)-1,o=e[l],c=1+l,s=e[c];if(u(o,n)<0)r=c<a&&u(s,o)<0?(e[r]=s,e[c]=n,c):(e[r]=o,e[l]=n,l);else{if(!(c<a&&u(s,n)<0))break;e[r]=s,e[c]=n,r=c}}}}}function u(e,t){var n=e.sortIndex-t.sortIndex;return 0!=n?n:e.id-t.id}"object"==typeof performance&&"function"==typeof performance.now?(t=performance,o.unstable_now=function(){return t.now()}):(n=Date,r=n.now(),o.unstable_now=function(){return n.now()-r});var t,n,r,d=[],f=[],l=1,p=null,v=3,m=!1,g=!1,h=!1,a="function"==typeof setTimeout?setTimeout:null,b="function"==typeof clearTimeout?clearTimeout:null,y="undefined"!=typeof setImmediate?setImmediate:null;function E(e){for(var t=c(f);null!==t;){if(null===t.callback)s(f);else{if(!(t.startTime<=e))break;s(f),t.sortIndex=t.expirationTime,i(d,t)}t=c(f)}}function _(e){var t;h=!1,E(e),g||(null!==c(d)?(g=!0,P(C)):null!==(t=c(f))&&R(_,t.startTime-e))}function C(e,t){g=!1,h&&(h=!1,b(S),S=-1),m=!0;var n=v;try{for(E(t),p=c(d);null!==p&&(!(p.expirationTime>t)||e&&!A());){var r,a=p.callback;"function"==typeof a?(p.callback=null,v=p.priorityLevel,r=a(p.expirationTime<=t),t=o.unstable_now(),"function"==typeof r?p.callback=r:p===c(d)&&s(d),E(t)):s(d),p=c(d)}var i,l=null!==p||(null!==(i=c(f))&&R(_,i.startTime-t),!1);return l}finally{p=null,v=n,m=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var x,k,O,N=!1,w=null,S=-1,T=5,I=-1;function A(){return!(o.unstable_now()-I<T)}function D(){if(null!==w){var e=o.unstable_now(),t=(I=e,!0);try{t=w(!0,e)}finally{t?x():(N=!1,w=null)}}else N=!1}function P(e){w=e,N||(N=!0,x())}function R(e,t){S=a(function(){e(o.unstable_now())},t)}x="function"==typeof y?function(){y(D)}:"undefined"!=typeof MessageChannel?(k=new MessageChannel,O=k.port2,k.port1.onmessage=D,function(){O.postMessage(null)}):function(){a(D,0)},o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(e){e.callback=null},o.unstable_continueExecution=function(){g||m||(g=!0,P(C))},o.unstable_forceFrameRate=function(e){e<0||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},o.unstable_getCurrentPriorityLevel=function(){return v},o.unstable_getFirstCallbackNode=function(){return c(d)},o.unstable_next=function(e){switch(v){case 1:case 2:case 3:var t=3;break;default:t=v}var n=v;v=t;try{return e()}finally{v=n}},o.unstable_pauseExecution=function(){},o.unstable_requestPaint=function(){},o.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=v;v=e;try{return t()}finally{v=n}},o.unstable_scheduleCallback=function(e,t,n){var r=o.unstable_now();switch(n="object"==typeof n&&null!==n&&"number"==typeof(n=n.delay)&&0<n?r+n:r,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:l++,callback:t,priorityLevel:e,startTime:n,expirationTime:a=n+a,sortIndex:-1},r<n?(e.sortIndex=n,i(f,e),null===c(d)&&e===c(f)&&(h?(b(S),S=-1):h=!0,R(_,n-r))):(e.sortIndex=a,i(d,e),g||m||(g=!0,P(C))),e},o.unstable_shouldYield=A,o.unstable_wrapCallback=function(t){var n=v;return function(){var e=v;v=n;try{return t.apply(this,arguments)}finally{v=e}}}},840:(e,t,n)=>{e.exports=n(53)}}]);